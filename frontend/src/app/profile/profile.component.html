<div *ngIf="user" class="profile-container">
  <mat-card class="profile-card">
    <div class="flex flex-1">
      <div class="flex flex-col items-center mb-5 ">
        <img
          [alt]="user.username"
          [src]="user.main_photo_url || 'assets/default-profile.png'"
          class="profile-picture"
        />
        <h2>{{ user.first_name }} {{ user.last_name }}</h2>
        <p class="username">{{ '@' + user.username }}</p>
      </div>
      <div class="bg-rose-400 h-full"></div>
    </div>
    <mat-card-content>
      <p><strong>Email:</strong> {{ user.email }}</p>
      <p><strong>Gender:</strong> {{ getGenderName(user.gender) }}</p>
      <p>
        <strong>Interested In:</strong>
        {{ getSexualPreferencesNames(user.sexualPreferences) }}
      </p>
      <p><strong>Bio:</strong> {{ user.biography }}</p>
      <p>
        <strong>Interests:</strong>
        <span *ngFor="let tag of user.tags">{{ tag.tag_name }} </span>
      </p>
      <p><strong>Fame Rating:</strong> {{ user.fame_rating | number: '1.2-2' }}</p>
    </mat-card-content>
    @if (!profileId) {
      <mat-card-actions>
        <button (click)="onEditProfile()" color="primary" mat-button>
          <mat-icon>edit</mat-icon>
          Edit Profile
        </button>
        <button (click)="onDeleteProfile()" color="warn" mat-button>
          <mat-icon>delete</mat-icon>
          Delete Profile
        </button>
      </mat-card-actions>
    } @else {
      <div class="grid grid-cols-2 gap-1 pt-6">
        <button [ngClass]="{'like': user.isLiked}" class="button-base" (click)="toggleLike()" mat-raised-button>
          <mat-icon>favorite</mat-icon>
          Like
        </button>
        <button [ngClass]="{'unlike': user.isUnliked}" class="button-base" (click)="toggleUnlike()" mat-raised-button>
          <mat-icon>thumb_down</mat-icon>
          Unlike
        </button>
        <button [ngClass]="{'blocked': user.isBlocked}" class="button-base" (click)="toggleBlock()" mat-raised-button>
          <mat-icon>block</mat-icon>
          Block
        </button>

        <button [ngClass]="{'reported': user.isFakeReported}" class="button-base" (click)="toggleReportFake()"
                mat-raised-button>
          <mat-icon>error</mat-icon>
          Fake report
        </button>
      </div>


    }
  </mat-card>

  <div *ngIf="user.photos && user.photos.length" class="profile-images">
    <h3>Photo Gallery</h3>
    <div class="images-grid">
      <div *ngFor="let photo of user.photos" class="photo-item">
        <img [alt]="user.username" [src]="photo.url"/>
        @if (!profileId) {
          <div class="photo-actions">
            <button (click)="deletePhoto(photo)" color="warn" mat-icon-button>
              <mat-icon>delete</mat-icon>
            </button>
            <mat-icon
              *ngIf="photo.url === user.main_photo_url"
              class="main-photo-indicator"
              color="primary">
              star
            </mat-icon>
          </div>
        }
      </div>
    </div>
  </div>
</div>

<div *ngIf="!user" class="loading-state">
  <mat-spinner diameter="40"></mat-spinner>
  <p>Loading profile...</p>
</div>
